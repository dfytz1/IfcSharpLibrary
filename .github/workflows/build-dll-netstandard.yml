# Add this to your FORK of IfcSharpLibrary as: .github/workflows/build-dll-netstandard.yml
# This builds a .NET Standard 2.0 DLL that can load on Rhino 8 Mac.
# You must also add the file IfcSharpLibrary.NetStandard.csproj to the repo root.

name: Build IfcSharpLibrary (NET Standard 2.0 for Mac)

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: "8.0.x"

      - name: Build NET Standard 2.0
        run: dotnet build IfcSharpLibrary.NetStandard.csproj -c Release -v minimal

      - name: Prepare artifact
        run: |
          mkdir -p artifact
          DLL=$(find . -name "IfcSharpLibrary.dll" -path "*/netstandard2.0/*" 2>/dev/null | head -1)
          if [ -z "$DLL" ]; then DLL=$(find . -name "IfcSharpLibrary.dll" 2>/dev/null | head -1); fi
          if [ -z "$DLL" ]; then echo "DLL not found"; exit 1; fi
          cp "$DLL" artifact/IfcSharpLibrary.dll
          ls -la artifact/

      - name: Upload DLL
        uses: actions/upload-artifact@v4
        with:
          name: IfcSharpLibrary-netstandard2-dll
          path: artifact/IfcSharpLibrary.dll
